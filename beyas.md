



联合概率：$p(X, Y)$ 表示两个时间同时发生的概率

条件概率：$p(X| Y)$ 表示在标签为y的时候x发生的概率



贝叶斯公式：

​				$p(Y|X) = \frac{p(X|Y)*p(Y)}{p(X)}$	

贝叶斯公式相当于一个概率的转化率，$p(Y|X)$ 相当于要求的在特征向量 X 下，样本被分为 Y 的概率（后验概率），转换为$p(X|Y)$ 先验概率，假设这些特征之间都是相互独立的，这个概率又可以等于$p(x_1=?|Y) *p(x_2=?|Y)*...p(x_n=?|Y)$，乘以剩下的就好算了，因为要进行分类的概率比较，所以分母不用算。



对于连续型变量的概率估计：

计算连续型变量的概率分布，设概率密度曲线$f(x)$，表示其概率分布，表示连续型的特征变量x取到的概率，现实中往往可以假设 $f(x)$ 样本服从某种分布（正态分布，伯努利分布，多项式分布），正是对应于这些分布，$f(x)$ 对应于不同的曲线，也对应于不同的贝叶斯算法。



贝叶斯是速度很快，但分类效果一般，并且初次训练之后的结果就很接近算法极限 的算法，几乎没有调参的余地。也就是说，如果我们追求对概率的预测，并且希望越准确越好，那我们应该先选择逻辑回归。如果数据十分复杂，或者是稀疏矩阵，那我们坚定地使用贝叶斯。如果我们分类的目标不是要追求对概率的预测，那我们完全可以先试试看高斯朴素贝叶斯的效果（反正它运算很快速，还不需要太多的样本），如果效果很不 错，我们就很幸运地得到了一个表现优秀又快速的模型。如果我们没有得到比较好的结果，那我们完全可以选择再更换成更加复杂的模型。



概率模型的评估指标：

1）布里尔分数：计算概率预测对于测试样本的均方误差，即每个样本的预测概率减去真实标签 0 或 1的平方的均值，其结果的取值范围是0-1，越接近1，模型的预测结果越差，其本质上实在衡量损失

2）对数似然函数：在预测概率为条件的情况下，真实概率发生的可能性的负对数，这个值越小，概率模型越理想

![1567431366377](C:\Users\Liang\AppData\Roaming\Typora\typora-user-images\1567431366377.png)

![1567431400656](C:\Users\Liang\AppData\Roaming\Typora\typora-user-images\1567431400656.png)

3）可靠性曲线：以预测概率为横坐标，真实概率为纵坐标，所以斜率越接近于45°越好



对于贝叶斯，如果概率校准曲线呈现sigmoid函数的镜像的情况，则说明数据集中的特征不是相互条件独立的。贝叶 斯原理中的”朴素“原则：特征相互条件独立原则被违反了（这其实是我们自己的设定，我们设定了10个冗余特征，这 些特征就是噪音，他们之间不可能完全独立），因此贝叶斯的表现不够好



高斯朴素贝叶斯：

假设样本的每个特征下每个类别上的条件概率 $P(x_i|Y)$ 服从正态分布，对于每一个特征下的取值都服从正太分布的概率密度公式

![1568174880862](C:\Users\Liang\AppData\Roaming\Typora\typora-user-images\1568174880862.png)

对于给定的一个标签 Y 的值，贝叶斯都以求解最大化的 $P(x_i|Y)$ 为目标，所有使用极大似然估计来求解能使得这个似然函数最大化的 μ 和 *σ*
$$
L = \prod_{i=1}^nP(x_i|Y)
$$
求解步骤：

1. 取对数似然
2. 分别对 μ 和 *σ* 求偏导，令导函数等于0

经过上面两步解出：

![1568212164970](C:\Users\Liang\AppData\Roaming\Typora\typora-user-images\1568212164970.png)

里面的 n 和 x~i~ 就是从数据集中获得的，求得 μ 和 σ 这两个参数之后，传入一个样本的$x_i$，就可以得到一个对应的先验概率 $P(x_i|Y)$ 





多项式朴素贝叶斯：

高斯朴素贝叶斯更适用于连续型特征变量，高斯朴素贝叶斯的先验概率 $P(x_i|Y)$ 是通过当前这个**样本**的特征向量

多项式朴素贝叶斯更适用于离散型特征变量，多项式朴素贝叶斯求解先验概率 $P(x_i|Y)$ 是通过在当前这个标签下的特征矩阵来求的

